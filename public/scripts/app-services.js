"use strict";

(function (undefined) {
    // Get angular app
    var app = angular.module("scraper");

    app.factory("XLSXReaderService", ['$q', '$rootScope', function ($q, $rootScope) {
        var service = function service(data) {
            angular.extend(this, data);
        };

        service.readFile = function (file, showPreview) {
            var deferred = $q.defer();

            XLSXReader(file, showPreview, function (data) {
                $rootScope.$apply(function () {
                    deferred.resolve(data);
                });
            });

            return deferred.promise;
        };

        return service;
    }]);
}).call(undefined);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zY3JpcHRzL2FwcC1zZXJ2aWNlcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLENBQUMsVUFBUyxTQUFTLEVBQUU7O0FBRWpCLFFBQUksR0FBRyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUE7O0FBRW5DLE9BQUcsQ0FBQyxPQUFPLENBQUMsbUJBQW1CLEVBQUUsQ0FBQyxJQUFJLEVBQUUsWUFBWSxFQUNoRCxVQUFTLEVBQUUsRUFBRSxVQUFVLEVBQUU7QUFDckIsWUFBSSxPQUFPLEdBQUcsU0FBVixPQUFPLENBQVksSUFBSSxFQUFFO0FBQ3pCLG1CQUFPLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztTQUM5QixDQUFDOztBQUVGLGVBQU8sQ0FBQyxRQUFRLEdBQUcsVUFBUyxJQUFJLEVBQUUsV0FBVyxFQUFFO0FBQzNDLGdCQUFJLFFBQVEsR0FBRyxFQUFFLENBQUMsS0FBSyxFQUFFLENBQUM7O0FBRTFCLHNCQUFVLENBQUMsSUFBSSxFQUFFLFdBQVcsRUFBRSxVQUFTLElBQUksRUFBQztBQUN4QywwQkFBVSxDQUFDLE1BQU0sQ0FBQyxZQUFXO0FBQ3pCLDRCQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO2lCQUMxQixDQUFDLENBQUM7YUFDTixDQUFDLENBQUM7O0FBRUgsbUJBQU8sUUFBUSxDQUFDLE9BQU8sQ0FBQztTQUMzQixDQUFDOztBQUVGLGVBQU8sT0FBTyxDQUFDO0tBQ2xCLENBQ0osQ0FBQyxDQUFDO0NBQ04sQ0FBQSxDQUFFLElBQUksV0FBTSxDQUFDIiwiZmlsZSI6ImFwcC1zZXJ2aWNlcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbih1bmRlZmluZWQpIHtcbiAgICAvLyBHZXQgYW5ndWxhciBhcHBcbiAgICB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoXCJzY3JhcGVyXCIpXG5cbiAgICBhcHAuZmFjdG9yeShcIlhMU1hSZWFkZXJTZXJ2aWNlXCIsIFsnJHEnLCAnJHJvb3RTY29wZScsXG4gICAgICAgIGZ1bmN0aW9uKCRxLCAkcm9vdFNjb3BlKSB7XG4gICAgICAgICAgICB2YXIgc2VydmljZSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZCh0aGlzLCBkYXRhKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHNlcnZpY2UucmVhZEZpbGUgPSBmdW5jdGlvbihmaWxlLCBzaG93UHJldmlldykge1xuICAgICAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgICAgICBYTFNYUmVhZGVyKGZpbGUsIHNob3dQcmV2aWV3LCBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIH1cbiAgICBdKTtcbn0pLmNhbGwodGhpcyk7Il19
